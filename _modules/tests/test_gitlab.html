<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tests.test_gitlab &mdash; Career Center  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Career Center
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Career Center</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">tests.test_gitlab</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for tests.test_gitlab</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dumps</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">SimpleNamespace</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">cast</span>
<span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">,</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">mock</span>
<span class="kn">from</span> <span class="nn">unittest.mock</span> <span class="kn">import</span> <span class="n">patch</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urljoin</span>

<span class="kn">from</span> <span class="nn">aiohttp</span> <span class="kn">import</span> <span class="n">ClientSession</span>
<span class="kn">import</span> <span class="nn">jwt</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">app.gitlab_facade</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Gitlab</span><span class="p">,</span> <span class="n">GitlabConfig</span><span class="p">,</span> <span class="n">LearningTrackMetadata</span><span class="p">,</span> <span class="n">LevelEnum</span><span class="p">,</span> <span class="n">GitlabError</span><span class="p">,</span>
    <span class="n">ResourceProgress</span><span class="p">,</span> <span class="n">ResourceTypeEnum</span><span class="p">,</span> <span class="n">UserInfo</span><span class="p">,</span> <span class="n">LearningTrackData</span><span class="p">,</span> <span class="n">Creator</span><span class="p">,</span>
    <span class="n">Lesson</span><span class="p">,</span> <span class="n">Resource</span><span class="p">,</span> <span class="n">AllLearningTracks</span><span class="p">,</span> <span class="n">UserProgress</span><span class="p">,</span> <span class="n">LearningTrackCommit</span><span class="p">,</span>
    <span class="n">GitlabImage</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">gitlab_facade</span>
<span class="kn">from</span> <span class="nn">tests.mock_session</span> <span class="kn">import</span> <span class="n">FakeResponse</span><span class="p">,</span> <span class="n">FakeSession</span>

<span class="n">TEST_HOSTNAME</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8080&quot;</span>


<div class="viewcode-block" id="GitlabMixin"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabMixin">[docs]</a><span class="k">class</span> <span class="nc">GitlabMixin</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabMixin.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabMixin.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span> <span class="o">=</span> <span class="n">FakeSession</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span> <span class="o">=</span> <span class="n">Gitlab</span><span class="p">(</span>
            <span class="n">config</span><span class="o">=</span><span class="n">GitlabConfig</span><span class="p">(</span><span class="n">gitlab_hostname</span><span class="o">=</span><span class="n">TEST_HOSTNAME</span><span class="p">),</span>
            <span class="n">session</span><span class="o">=</span><span class="n">cast</span><span class="p">(</span><span class="n">ClientSession</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="p">))</span>
        <span class="n">Gitlab</span><span class="o">.</span><span class="n">_rsa_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="GitlabMixin.endpoint"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabMixin.endpoint">[docs]</a>    <span class="k">def</span> <span class="nf">endpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">TEST_HOSTNAME</span><span class="si">}{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span></div></div>


<div class="viewcode-block" id="approx_date"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.approx_date">[docs]</a><span class="k">def</span> <span class="nf">approx_date</span><span class="p">(</span><span class="n">date1</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
                <span class="n">date2</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span>
                <span class="n">delta</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if two dates are approximately equal.</span>

<span class="sd">    Args:</span>
<span class="sd">        date1: First date.</span>
<span class="sd">        date2: Second date. Defaults to now.</span>
<span class="sd">        delta: Maximum difference between dates.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the dates are approximately equal, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">date1</span> <span class="o">-</span> <span class="n">delta</span> <span class="o">&lt;</span>
            <span class="p">(</span><span class="n">date2</span> <span class="ow">or</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">UTC</span><span class="p">))</span> <span class="o">&lt;</span>
            <span class="n">date1</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span></div>


<div class="viewcode-block" id="GitlabLoginTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabLoginTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabLoginTestCase.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwk_patcher</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;app.gitlab_facade.PyJWKClient&quot;</span><span class="p">,</span>
                                 <span class="n">autospec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spec_set</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decode_patcher</span> <span class="o">=</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;app.gitlab_facade.jwt_decode&quot;</span><span class="p">,</span>
                                    <span class="n">autospec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">spec_set</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwk_client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jwk_patcher</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwk_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="n">get_signing_key_from_jwt</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">SimpleNamespace</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;test_key&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">jwt_decode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_patcher</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwt_decode</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;sub&quot;</span><span class="p">:</span> <span class="mi">1337</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;preferred_username&quot;</span><span class="p">:</span> <span class="s2">&quot;test_username&quot;</span><span class="p">,</span>
            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;test_email&quot;</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="s2">&quot;test_access&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;token_type&quot;</span><span class="p">:</span> <span class="s2">&quot;bearer&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="s2">&quot;test_refresh&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;expires_in&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
                    <span class="s2">&quot;id_token&quot;</span><span class="p">:</span> <span class="s2">&quot;quim barreiros&quot;</span><span class="p">})</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.tearDown"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">tearDown</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwk_patcher</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decode_patcher</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.test_login"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.test_login">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test login to Gitlab, with a successful response.&quot;&quot;&quot;</span>

        <span class="n">token</span><span class="p">,</span> <span class="n">user_info</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">login</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;username&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">access_token</span><span class="p">,</span> <span class="s2">&quot;test_access&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">token_type</span><span class="p">,</span> <span class="s2">&quot;bearer&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">,</span> <span class="s2">&quot;test_refresh&quot;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">approx_date</span><span class="p">(</span>
            <span class="n">token</span><span class="o">.</span><span class="n">expiration_date</span><span class="p">,</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">UTC</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">))</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;scope&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)),</span>
                         <span class="p">{</span><span class="s2">&quot;api&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="s2">&quot;openid&quot;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;grant_type&#39;</span><span class="p">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;username&#39;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/oauth/token&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">jwk_client</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">(</span><span class="s2">&quot;/oauth/discovery/keys&quot;</span><span class="p">),</span>
            <span class="n">cache_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">lifespan</span><span class="o">=</span><span class="n">mock</span><span class="o">.</span><span class="n">ANY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwt_decode</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span>
            <span class="s2">&quot;quim barreiros&quot;</span><span class="p">,</span>
            <span class="n">algorithms</span><span class="o">=</span><span class="n">Gitlab</span><span class="o">.</span><span class="n">_JWT_ALGORITHMS</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;test_key&quot;</span><span class="p">)</span>

        <span class="n">expected_info</span> <span class="o">=</span> <span class="n">UserInfo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1337</span><span class="p">,</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_name&quot;</span><span class="p">,</span>
                                 <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_username&quot;</span><span class="p">,</span>
                                 <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test_email&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">expected_info</span><span class="p">,</span> <span class="n">user_info</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.test_invalid_jwt_configuration"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.test_invalid_jwt_configuration">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_invalid_jwt_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwk_client</span><span class="o">.</span><span class="n">return_value</span><span class="o">.</span><span class="n">get_signing_key_from_jwt</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">jwt</span><span class="o">.</span><span class="n">PyJWKClientError</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;.*JWT token&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.test_invalid_jwt_token"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.test_invalid_jwt_token">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_invalid_jwt_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jwt_decode</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span><span class="p">()</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;.*JWT token&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.test_login_bad_credentials"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.test_login_bad_credentials">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_login_bad_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Incorrect credentials&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">FakeResponse</span><span class="p">(</span><span class="mi">400</span><span class="p">))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span>
            <span class="s2">&quot;.*credentials&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.test_login_gitlab_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.test_login_gitlab_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_login_gitlab_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">FakeResponse</span><span class="p">(</span><span class="mi">500</span><span class="p">))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span>
                                    <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabLoginTestCase.test_gitlab_returns_invalid_data"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabLoginTestCase.test_gitlab_returns_invalid_data">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_gitlab_returns_invalid_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">FakeResponse</span><span class="p">(</span>
            <span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;access_token&quot;</span><span class="p">:</span> <span class="s2">&quot;test_access&quot;</span><span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span>
                                    <span class="s2">&quot;Invalid data returned by Gitlab&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;asd&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabRegisterTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabRegisterTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabRegisterTestCase.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="s2">&quot;test_access&quot;</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/users&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">})</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_gitlab_username_exists"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_gitlab_username_exists">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_gitlab_username_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 409 when username already exists&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span>
                         <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                             <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Username has already been taken&quot;</span><span class="p">})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">EntityAlreadyExists</span><span class="p">,</span> <span class="s2">&quot;username&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_gitlab_email_exists"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_gitlab_email_exists">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_gitlab_email_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 409 when email already exists&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span>
                         <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Email has already been taken&quot;</span><span class="p">})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">EntityAlreadyExists</span><span class="p">,</span>
            <span class="s2">&quot;email&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">cm</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">exception</span><span class="o">.</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;test@example.com&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_gitlab_409"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_gitlab_409">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_gitlab_409</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 409&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">409</span><span class="p">,</span>
                         <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">_ClientResponseBodyError</span><span class="p">,</span>
            <span class="s2">&quot;409&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_gitlab_401"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_gitlab_401">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_gitlab_401</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 401&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">401</span><span class="p">,</span>
                         <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Unauthorized</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_invalid_password"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_invalid_password">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_invalid_password</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 400 when password is too short&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;message&quot;</span><span class="p">:</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">password</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;is too short (minimum is 8 characters)&quot;</span><span class="p">])})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="s2">&quot;is too short&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_invalid_data"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_invalid_data">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_invalid_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 400 when data is invalid&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                         <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="p">{}})</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="s2">&quot;Invalid data&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRegisterTestCase.test_register_gitlab_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRegisterTestCase.test_register_gitlab_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_register_gitlab_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 500 when something goes wrong&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">RegisterData</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test User&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@example.com&quot;</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabGetLearningTrackTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabGetLearningTrackTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="s2">&quot;test_access&quot;</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_get_learning_track_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_get_learning_track_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2121</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;d142e040117e680aafe515a53a33f4baeb49fc38953&quot;</span>
                <span class="s2">&quot;5edeb91869a917b173571&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f5443b5921eb1b4fa4367eaffa17532b213d47b2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d6fa002403c8515afe0d0f215cfdf7f2631ef518&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d6fa002403c8515afe0d0f215cfdf7f2631ef518&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;ewoJImNhcmVlcl9wYXRoIjogInNvbWVDYXJlZXJQYXRoIiw&quot;</span>
                <span class="s2">&quot;KCSJsZXZlbCI6ICJleHBlcnQiLAoJInNraWxscyI6ICJza2lsbHMiL&quot;</span>
                <span class="s2">&quot;AoJImxlc3NvbnMiOiBbewoJCSJsZXNzb25faWQiOiAic29tZVVVSUQ&quot;</span>
                <span class="s2">&quot;iLAoJCSJuYW1lIjogInNvbWVOYW1lIiwKCQkicmVzb3VyY2VzIjogW3&quot;</span>
                <span class="s2">&quot;sKCQkJCSJsaW5rIjogImh0dHA6Ly8uc29tZWxpbmsuY29tIiwKCQkJC&quot;</span>
                <span class="s2">&quot;SJyZXNvdXJjZV9pZCI6ICJzb21lVVVJRCIsCgkJCQkidGl0bGUiOiAi&quot;</span>
                <span class="s2">&quot;c29tZVRpdGxlIiwKCQkJCSJzb3VyY2UiOiAic29tZVRpdGxlIiwKCQkJ&quot;</span>
                <span class="s2">&quot;CSJyZXNvdXJjZV90eXBlIjogImJvb2siLAoJCQkJImR1cmF0aW9uIjog&quot;</span>
                <span class="s2">&quot;MTAsCgkJCQkiYWRkZWRCeSI6ICJxdWltYmFycmVpcm9zIgoJCQl9LAoJ&quot;</span>
                <span class="s2">&quot;CQl7CgkJCQkibGluayI6ICJodHRwOi8vLnNvbWVsaW5rLmNvbSIsCgkJ&quot;</span>
                <span class="s2">&quot;CQkicmVzb3VyY2VfaWQiOiAic29tZVVVSUQiLAoJCQkJInRpdGxlIjog&quot;</span>
                <span class="s2">&quot;InNvbWVUaXRsZSIsCgkJCQkic291cmNlIjogInNvbWVUaXRsZSIsCgkJ&quot;</span>
                <span class="s2">&quot;CQkicmVzb3VyY2VfdHlwZSI6ICJib29rIiwKCQkJCSJkdXJhdGlvbiI6&quot;</span>
                <span class="s2">&quot;IDEwLAoJCQkJImFkZGVkQnkiOiAicXVpbWJhcnJlaXJvcyIKCQkJfQoJ&quot;</span>
                <span class="s2">&quot;CV0KCgl9XQp9&quot;</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;builds_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career_path</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string3</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">level</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">expert</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://i.postimg.cc/wM8xN4pv/animals-&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;pixelated-very-small-16x16-v0-aatcct01bfoa1.jpg&quot;</span><span class="p">,</span>
            <span class="p">}))</span>

        <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="s2">&quot;images/animals-pixelated.png&quot;</span><span class="p">)</span>
        <span class="c1"># with open(image_path, &quot;rb&quot;) as image:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="c1"># thumbnail_image = BytesIO(image.read())</span>
        <span class="n">thumbnail_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">image</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># thumbnail_image = image</span>
        <span class="c1"># size = image.read()</span>
        <span class="c1"># thumbnail_image.seek(0)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">thumbnail_image</span><span class="p">,</span>
                <span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;image/png&quot;</span><span class="p">,</span>
                <span class="n">content_length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">thumbnail_image</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track</span><span class="p">(</span><span class="s2">&quot;12345&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;https://i.postimg.cc/wM8xN4pv/animals-pixelated-very-small-16x16-v0-aatcct01bfoa1.jpg&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>

        <span class="c1"># self.assertEqual(request.url, urljoin(</span>
        <span class="c1">#     TEST_HOSTNAME, &quot;/api/v4/projects/12345&quot;))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">LearningTrackData</span><span class="p">(</span>
            <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
            <span class="n">is_draft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_private</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;str1&#39;</span><span class="p">,</span>
            <span class="n">career</span><span class="o">=</span><span class="s1">&#39;string2&#39;</span><span class="p">,</span>
            <span class="n">career_path</span><span class="o">=</span><span class="s1">&#39;string3&#39;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span>
            <span class="n">thumbnail_image</span><span class="o">=</span><span class="s2">&quot;data:image/jpg;base64,&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;BccqhmAAADA0lEQVR42u3csY2DMBSA4eMUUTEJ&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;k1CwAQOxAQsgNqAwA1C7YwBmoCcDXLp3kiXyff&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;0TiUN+ubGrnPP9A3ylX0sAAgAIACAAgAAAAgAI&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;ACAAgAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;gAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAAgAAAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;gAIACAAgACAAAACAAgAIACAAAACAAgAIACAAAACAAg&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AIACAAAACAAgAIACAAAACAAgAIACAAAACAAgAIACAAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;ACAAgAIACAAAACAAgAIACAAAACAAgAIACAAIAAAAIACAAgAIAAAE&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;/2sgRlLcsSmh+GwefHDgAQAEAAAAEABAAQAEAAAAEABAAEABAAQAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AAQAEABAA4HncB1BYXdeh+eh5/NKfHzsAQAAAAQAEABAAQAAAAQAE&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;ABAAQAAAAQAEABAAQAAAAQA+ch9AUPQ8/r7vofl1XUPzfd8Xff55&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;nl4iOwBAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAP6q&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;cs63ZSgnep9AVNM0RZ+/bVtofpomL5EdACAAgAAAAgAIACAAgAAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AgAIAAgAIACAAAACAAgAIADAE70sQVkppdB813Wh+eu6in5/5/nt&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQA+Mh9AEH&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;jOIbmo+f5m6bxI2AHAAgAIACAAAACAAgAIACAAAACAAIACAAgA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;IAAAAIACADwPF9/H8CyLEWfn1IKzbdtG5o/jiM0P8+zf5EdACAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;gAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAAgAAA/6/KOd+WAew&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;EABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEAB&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AAQABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAE&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;ABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQCC3vIiOZAJf1Z6AA&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;AAAElFTkSuQmCC&quot;</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="s1">&#39;expert&#39;</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">],</span>
            <span class="n">skills</span><span class="o">=</span><span class="s1">&#39;skills&#39;</span><span class="p">,</span>
            <span class="n">createdBy</span><span class="o">=</span><span class="n">Creator</span><span class="p">(</span>
                <span class="n">username</span><span class="o">=</span><span class="s1">&#39;antonio&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;antonio antonio&#39;</span><span class="p">,</span>
                <span class="n">avatar</span><span class="o">=</span><span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                <span class="n">creator_id</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
            <span class="n">lessons</span><span class="o">=</span><span class="p">[</span>
                <span class="n">Lesson</span><span class="p">(</span><span class="n">lesson_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                       <span class="n">name</span><span class="o">=</span><span class="s1">&#39;someName&#39;</span><span class="p">,</span>
                       <span class="n">resources</span><span class="o">=</span><span class="p">[</span>
                                 <span class="n">Resource</span><span class="p">(</span><span class="n">resource_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                                          <span class="n">link</span><span class="o">=</span><span class="s1">&#39;http://.somelink.com&#39;</span><span class="p">,</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                                          <span class="n">source</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                                          <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;book&#39;</span><span class="p">,</span>
                                          <span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                          <span class="n">addedBy</span><span class="o">=</span><span class="s1">&#39;quimbarreiros&#39;</span><span class="p">),</span>
                                 <span class="n">Resource</span><span class="p">(</span><span class="n">resource_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                                          <span class="n">link</span><span class="o">=</span><span class="s1">&#39;http://.somelink.com&#39;</span><span class="p">,</span>
                                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                                          <span class="n">source</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                                          <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;book&#39;</span><span class="p">,</span>
                                          <span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                          <span class="n">addedBy</span><span class="o">=</span><span class="s1">&#39;quimbarreiros&#39;</span><span class="p">)])])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_learning_track_gitlab_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_learning_track_gitlab_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_learning_track_gitlab_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 500 when something goes wrong&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track</span><span class="p">(</span><span class="s2">&quot;12345&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_learning_track_gitlab_401"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_learning_track_gitlab_401">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_learning_track_gitlab_401</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 401&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">401</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
            <span class="n">expected_exception</span><span class="o">=</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Unauthorized</span><span class="p">,</span>
            <span class="n">expected_regex</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track</span><span class="p">(</span><span class="s2">&quot;12345&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_learning_track_gitlab_404"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_learning_track_gitlab_404">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_learning_track_gitlab_404</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 404&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabLookupError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track</span><span class="p">(</span><span class="s2">&quot;123456&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_all_learning_track_gitlab_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span>
                    <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">someDescription</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                        <span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">someCareer</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career_path</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                        <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">someCareerPath</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">level</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">expert</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567891 3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name_with_namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator / 1234567891 3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567891-3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;path_with_namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;root/1234567891-3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T21:46:21.768Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;default_branch&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;two&quot;</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;one&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;two&quot;</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;forks_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://i.postimg.cc/wM8xN4pv/animals&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;-pixelated-very-small-16x16-v0-aatcct01bfoa1.jpg&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;star_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;last_activity_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T21:46:21.768Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;packages_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;empty_repo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;archived&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;resolve_outdated_diff_discussions&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;issues_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;merge_requests_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;wiki_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;jobs_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;snippets_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;container_registry_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;service_desk_enabled&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;can_create_merge_request_in&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;issues_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;merge_requests_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;forking_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;wiki_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;builds_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;snippets_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;pages_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;analytics_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;container_registry_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;security_and_compliance_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;releases_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;environments_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;feature_flags_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;infrastructure_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;monitor_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;shared_runners_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;lfs_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;creator_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;import_status&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;open_issues_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T21:46:23.641Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ci_default_git_depth&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="s2">&quot;ci_forward_deployment_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;ci_job_token_scope_enabled&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;ci_separated_caches&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;build_git_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;keep_latest_artifact&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;restrict_user_defined_variables&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;runners_token&quot;</span><span class="p">:</span> <span class="s2">&quot;GR1348941nnsUYoeJZP-sA9fepw6X&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;group_runners_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;auto_cancel_pending_pipelines&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;build_timeout&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
                    <span class="s2">&quot;auto_devops_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;auto_devops_deploy_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;continuous&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;public_jobs&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;only_allow_merge_if_pipeline_succeeds&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;request_access_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;remove_source_branch_after_merge&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;printing_merge_request_link_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;merge_method&quot;</span><span class="p">:</span> <span class="s2">&quot;merge&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;squash_option&quot;</span><span class="p">:</span> <span class="s2">&quot;default_off&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;enforce_auth_checks_on_uploads&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;autoclose_referenced_issues&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;repository_storage&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
            <span class="p">))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_tracks</span><span class="p">(</span><span class="s2">&quot;some&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects?search=some&quot;</span><span class="p">))</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">AllLearningTracks</span><span class="p">(</span>
            <span class="n">learning_tracks</span><span class="o">=</span><span class="p">[</span>
                <span class="n">LearningTrackMetadata</span><span class="p">(</span>
                    <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">164</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;1234567891&#39;</span><span class="p">,</span>
                    <span class="n">is_draft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">career</span><span class="o">=</span><span class="s1">&#39;someCareer&#39;</span><span class="p">,</span>
                    <span class="n">career_path</span><span class="o">=</span><span class="s1">&#39;someCareerPath&#39;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;someDescription&#39;</span><span class="p">,</span>
                    <span class="n">thumbnail_image</span><span class="o">=</span><span class="s2">&quot;data:image/jpg;base64,&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;BccqhmAAADA0lEQVR42u3csY2DMBSA4eMUUTEJ&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;k1CwAQOxAQsgNqAwA1C7YwBmoCcDXLp3kiXyff&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;0TiUN+ubGrnPP9A3ylX0sAAgAIACAAgAAAAgAI&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ACAAgAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;gAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAAgAAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;gAIACAAgACAAAACAAgAIACAAAACAAgAIACAAAACAAg&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AIACAAAACAAgAIACAAAACAAgAIACAAAACAAgAIACAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ACAAgAIACAAAACAAgAIACAAAACAAgAIACAAIAAAAIACAAgAIAAAE&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;/2sgRlLcsSmh+GwefHDgAQAEAAAAEABAAQAEAAAAEABAAEABAAQAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAQAEABAA4HncB1BYXdeh+eh5/NKfHzsAQAAAAQAEABAAQAAAAQAE&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ABAAQAAAAQAEABAAQAAAAQA+ch9AUPQ8/r7vofl1XUPzfd8Xff55&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;nl4iOwBAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAP6q&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;cs63ZSgnep9AVNM0RZ+/bVtofpomL5EdACAAgAAAAgAIACAAgAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AgAIAAgAIACAAAACAAgAIADAE70sQVkppdB813Wh+eu6in5/5/nt&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQA+Mh9AEH&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;jOIbmo+f5m6bxI2AHAAgAIACAAAACAAgAIACAAAACAAIACAAgA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;IAAAAIACADwPF9/H8CyLEWfn1IKzbdtG5o/jiM0P8+zf5EdACAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;gAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAAgAAA/6/KOd+WAew&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;EABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEAB&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAQABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAE&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQCC3vIiOZAJf1Z6AA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAAElFTkSuQmCC&quot;</span><span class="p">,</span>
                    <span class="n">level</span><span class="o">=</span><span class="s1">&#39;expert&#39;</span><span class="p">,</span>
                    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">],</span>
                    <span class="n">createdBy</span><span class="o">=</span><span class="n">Creator</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Administrator&#39;</span><span class="p">,</span>
                        <span class="n">avatar</span><span class="o">=</span><span class="s1">&#39;https://www.gravatar.com/avatar/&#39;</span><span class="p">,</span>
                        <span class="n">username</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span>
                        <span class="n">creator_id</span><span class="o">=</span><span class="mi">1</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">],</span>
            <span class="n">hasResults</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_success_has_results_false"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_success_has_results_false">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_all_learning_track_gitlab_success_has_results_false</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">164</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span>
                    <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">someDescription</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                        <span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">someCareer</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career_path</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                        <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">someCareerPath</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\&quot;</span><span class="s2">level</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">expert</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567891 3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name_with_namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator / 1234567891 3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567891-3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;path_with_namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;root/1234567891-3d6edd&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T21:46:21.768Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;default_branch&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="s2">&quot;one&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;two&quot;</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;one&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;two&quot;</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;forks_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://i.postimg.cc/wM8xN4pv/animals-&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;pixelated-very-small-16x16-v0-aatcct01bfoa1.jpg&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;star_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;last_activity_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T21:46:21.768Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;packages_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;empty_repo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;archived&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;resolve_outdated_diff_discussions&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;issues_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;merge_requests_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;wiki_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;jobs_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;snippets_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;container_registry_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;service_desk_enabled&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;can_create_merge_request_in&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;issues_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;merge_requests_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;forking_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;wiki_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;builds_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;snippets_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;pages_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;analytics_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;container_registry_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;security_and_compliance_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;releases_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;environments_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;feature_flags_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;infrastructure_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;monitor_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;shared_runners_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;lfs_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;creator_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;import_status&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;open_issues_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-03T21:46:23.641Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ci_default_git_depth&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                    <span class="s2">&quot;ci_forward_deployment_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;ci_job_token_scope_enabled&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;ci_separated_caches&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;build_git_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;fetch&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;keep_latest_artifact&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;restrict_user_defined_variables&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;runners_token&quot;</span><span class="p">:</span> <span class="s2">&quot;GR1348941nnsUYoeJZP-sA9fepw6X&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;group_runners_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;auto_cancel_pending_pipelines&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;build_timeout&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
                    <span class="s2">&quot;auto_devops_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;auto_devops_deploy_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;continuous&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;public_jobs&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;only_allow_merge_if_pipeline_succeeds&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;request_access_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;remove_source_branch_after_merge&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;printing_merge_request_link_enabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;merge_method&quot;</span><span class="p">:</span> <span class="s2">&quot;merge&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;squash_option&quot;</span><span class="p">:</span> <span class="s2">&quot;default_off&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;enforce_auth_checks_on_uploads&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;autoclose_referenced_issues&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;repository_storage&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span>
                <span class="p">}</span>
            <span class="p">]</span>
            <span class="p">))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_tracks</span><span class="p">(</span><span class="s2">&quot;some&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects&quot;</span><span class="p">))</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">AllLearningTracks</span><span class="p">(</span>
            <span class="n">learning_tracks</span><span class="o">=</span><span class="p">[</span>
                <span class="n">LearningTrackMetadata</span><span class="p">(</span>
                    <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">164</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;1234567891&#39;</span><span class="p">,</span>
                    <span class="n">is_draft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_private</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">career</span><span class="o">=</span><span class="s1">&#39;someCareer&#39;</span><span class="p">,</span>
                    <span class="n">career_path</span><span class="o">=</span><span class="s1">&#39;someCareerPath&#39;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;someDescription&#39;</span><span class="p">,</span>
                    <span class="n">thumbnail_image</span><span class="o">=</span><span class="s2">&quot;data:image/jpg;base64,&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;BccqhmAAADA0lEQVR42u3csY2DMBSA4eMUUTEJ&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;k1CwAQOxAQsgNqAwA1C7YwBmoCcDXLp3kiXyff&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;0TiUN+ubGrnPP9A3ylX0sAAgAIACAAgAAAAgAI&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ACAAgAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;gAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAAgAAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;gAIACAAgACAAAACAAgAIACAAAACAAgAIACAAAACAAg&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AIACAAAACAAgAIACAAAACAAgAIACAAAACAAgAIACAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ACAAgAIACAAAACAAgAIACAAAACAAgAIACAAIAAAAIACAAgAIAAAE&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;/2sgRlLcsSmh+GwefHDgAQAEAAAAEABAAQAEAAAAEABAAEABAAQAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAQAEABAA4HncB1BYXdeh+eh5/NKfHzsAQAAAAQAEABAAQAAAAQAE&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ABAAQAAAAQAEABAAQAAAAQA+ch9AUPQ8/r7vofl1XUPzfd8Xff55&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;nl4iOwBAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAP6q&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;cs63ZSgnep9AVNM0RZ+/bVtofpomL5EdACAAgAAAAgAIACAAgAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AgAIAAgAIACAAAACAAgAIADAE70sQVkppdB813Wh+eu6in5/5/nt&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQA+Mh9AEH&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;jOIbmo+f5m6bxI2AHAAgAIACAAAACAAgAIACAAAACAAIACAAgA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;IAAAAIACADwPF9/H8CyLEWfn1IKzbdtG5o/jiM0P8+zf5EdACAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;gAAAAgAIACAAgAAAAgAIACAAgAAAAgAIACAAgAAA/6/KOd+WAew&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;EABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEAB&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAQABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAE&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;ABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQCC3vIiOZAJf1Z6AA&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;AAAElFTkSuQmCC&quot;</span><span class="p">,</span>
                    <span class="n">level</span><span class="o">=</span><span class="s1">&#39;expert&#39;</span><span class="p">,</span>
                    <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">],</span>
                    <span class="n">createdBy</span><span class="o">=</span><span class="n">Creator</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Administrator&#39;</span><span class="p">,</span>
                        <span class="n">avatar</span><span class="o">=</span><span class="s1">&#39;https://www.gravatar.com/avatar/&#39;</span><span class="p">,</span>
                        <span class="n">username</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span>
                        <span class="n">creator_id</span><span class="o">=</span><span class="mi">1</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">],</span>
            <span class="n">hasResults</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_all_learning_track_gitlab_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 500 when something goes wrong&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_tracks</span><span class="p">(</span><span class="s2">&quot;some&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_401"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabGetLearningTrackTestCase.test_all_learning_track_gitlab_401">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_all_learning_track_gitlab_401</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 401&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">401</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
            <span class="n">expected_exception</span><span class="o">=</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Unauthorized</span><span class="p">,</span>
            <span class="n">expected_regex</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track</span><span class="p">(</span><span class="s2">&quot;some&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabPostLearningTrackTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabPostLearningTrackTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabPostLearningTrackTestCase.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="s2">&quot;test_access&quot;</span>

        <span class="c1"># Get the directory path of the current file</span>
        <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

        <span class="c1"># Construct the path to the image file</span>
        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="s2">&quot;images/image.jpg&quot;</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">thumbnail_image</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">image</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">learning_track</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">LearningTrackData</span><span class="p">(</span>
            <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
            <span class="n">is_draft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_private</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;str1&#39;</span><span class="p">,</span>
            <span class="n">career</span><span class="o">=</span><span class="s1">&#39;string2&#39;</span><span class="p">,</span>
            <span class="n">career_path</span><span class="o">=</span><span class="s1">&#39;someCareerPath&#39;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span>
            <span class="n">thumbnail_image</span><span class="o">=</span><span class="n">thumbnail_image</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">LevelEnum</span><span class="o">.</span><span class="n">expert</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">],</span>
            <span class="n">skills</span><span class="o">=</span><span class="s1">&#39;skills&#39;</span><span class="p">,</span>
            <span class="n">createdBy</span><span class="o">=</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Creator</span><span class="p">(</span>
                <span class="n">username</span><span class="o">=</span><span class="s1">&#39;antonio&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;antonio antonio&#39;</span><span class="p">,</span>
                <span class="n">avatar</span><span class="o">=</span><span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                <span class="n">creator_id</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
            <span class="n">lessons</span><span class="o">=</span><span class="p">[</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Lesson</span><span class="p">(</span>
                    <span class="n">lesson_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;someName&#39;</span><span class="p">,</span>
                    <span class="n">resources</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span>
                            <span class="n">resource_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                            <span class="n">link</span><span class="o">=</span><span class="s1">&#39;http://.somelink.com&#39;</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                            <span class="n">source</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                            <span class="n">resource_type</span><span class="o">=</span><span class="n">ResourceTypeEnum</span><span class="o">.</span><span class="n">book</span><span class="p">,</span>
                            <span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                            <span class="n">addedBy</span><span class="o">=</span><span class="s1">&#39;quimbarreiros&#39;</span>
                        <span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">learning_track_invalid_image</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">LearningTrackData</span><span class="p">(</span>
            <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
            <span class="n">is_draft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">is_private</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;str1&#39;</span><span class="p">,</span>
            <span class="n">career</span><span class="o">=</span><span class="s1">&#39;string2&#39;</span><span class="p">,</span>
            <span class="n">career_path</span><span class="o">=</span><span class="s1">&#39;someCareerPath&#39;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;string1&#39;</span><span class="p">,</span>
            <span class="n">thumbnail_image</span><span class="o">=</span><span class="s2">&quot;bananas&quot;</span><span class="p">,</span>
            <span class="n">level</span><span class="o">=</span><span class="n">LevelEnum</span><span class="o">.</span><span class="n">expert</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">],</span>
            <span class="n">skills</span><span class="o">=</span><span class="s1">&#39;skills&#39;</span><span class="p">,</span>
            <span class="n">createdBy</span><span class="o">=</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Creator</span><span class="p">(</span>
                <span class="n">username</span><span class="o">=</span><span class="s1">&#39;antonio&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;antonio antonio&#39;</span><span class="p">,</span>
                <span class="n">avatar</span><span class="o">=</span><span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                <span class="n">creator_id</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
            <span class="n">lessons</span><span class="o">=</span><span class="p">[</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Lesson</span><span class="p">(</span>
                    <span class="n">lesson_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;someName&#39;</span><span class="p">,</span>
                    <span class="n">resources</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span>
                            <span class="n">resource_id</span><span class="o">=</span><span class="s1">&#39;someUUID&#39;</span><span class="p">,</span>
                            <span class="n">link</span><span class="o">=</span><span class="s1">&#39;http://.somelink.com&#39;</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                            <span class="n">source</span><span class="o">=</span><span class="s1">&#39;someTitle&#39;</span><span class="p">,</span>
                            <span class="n">resource_type</span><span class="o">=</span><span class="n">ResourceTypeEnum</span><span class="o">.</span><span class="n">book</span><span class="p">,</span>
                            <span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                            <span class="n">addedBy</span><span class="o">=</span><span class="s1">&#39;quimbarreiros&#39;</span>
                        <span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="GitlabPostLearningTrackTestCase.test_post_learning_track_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase.test_post_learning_track_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_learning_track_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;career&quot;</span><span class="p">:</span> <span class="s2">&quot;string2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;career_path&quot;</span><span class="p">:</span> <span class="s2">&quot;someCareerPath&quot;</span><span class="p">,</span>
                <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;expert&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;career&quot;</span><span class="p">:</span> <span class="s2">&quot;string2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;career_path&quot;</span><span class="p">:</span> <span class="s2">&quot;someCareerPath&quot;</span><span class="p">,</span>
                <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;expert&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;branch_name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span>
            <span class="p">}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_learning_track</span><span class="p">(</span>
            <span class="n">learning_track</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_track</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span>
            <span class="s2">&quot;/api/v4/projects/12345/repository/files/track.json&quot;</span><span class="p">))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="mi">12345</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabPostLearningTrackTestCase.test_post_learning_track_invalid_image"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase.test_post_learning_track_invalid_image">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_learning_track_invalid_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Image is not valid&quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="ne">ValueError</span><span class="p">,</span> <span class="s2">&quot;Invalid image.&quot;</span><span class="p">):</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_learning_track</span><span class="p">(</span>
                <span class="n">learning_track</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_track_invalid_image</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabPostLearningTrackTestCase.test_post_learning_track_gitlab_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase.test_post_learning_track_gitlab_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_learning_track_gitlab_error</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 500 when something goes wrong&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_learning_track</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_track</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabPostLearningTrackTestCase.test_post_learning_track_gitlab_401"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase.test_post_learning_track_gitlab_401">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_learning_track_gitlab_401</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 401&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">401</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Unauthorized</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_learning_track</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_track</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabPostLearningTrackTestCase.test_post_learning_track_gitlab_400"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabPostLearningTrackTestCase.test_post_learning_track_gitlab_400">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_learning_track_gitlab_400</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 400&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_learning_track</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_track</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabUserProgressTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabUserProgressTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabUserProgressTestCase.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="s2">&quot;test_access&quot;</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_snippet_id_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_snippet_id_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_snippet_id_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;User Progress&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T19:41:43.713Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T23:29:32.452Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw/&quot;</span>
                            <span class="s2">&quot;main/progress.json&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;test snippet 123&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;internal&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.175Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.371Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw/&quot;</span>
                            <span class="s2">&quot;main/test.txt&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">}]))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_snippet_id</span><span class="p">()</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/&quot;</span><span class="p">))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_snippet_id_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_snippet_id_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_snippet_id_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Arroz&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T19:41:43.713Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T23:29:32.452Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw/&quot;</span>
                            <span class="s2">&quot;main/progress.json&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;test snippet 123&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;internal&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.175Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.371Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw/&quot;</span>
                            <span class="s2">&quot;main/test.txt&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">}]))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_snippet_id</span><span class="p">()</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/&quot;</span><span class="p">))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_snippet_id_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_snippet_id_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_snippet_id_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[]))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GitlabError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_snippet_id</span><span class="p">()</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_snippet_id_error_404"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_snippet_id_error_404">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_snippet_id_error_404</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[]))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GitlabError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_snippet_id</span><span class="p">()</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_snippet_id_error_401"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_snippet_id_error_401">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_snippet_id_error_401</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">401</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[]))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">GitlabError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_snippet_id</span><span class="p">()</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_tracks_progress"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_tracks_progress">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_tracks_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Arroz&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T19:41:43.713Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T23:29:32.452Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw/&quot;</span>
                            <span class="s2">&quot;main/progress.json&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;test snippet 123&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;internal&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.175Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.371Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw/&quot;</span>
                            <span class="s2">&quot;main/test.txt&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]}]))</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_tracks_progress</span><span class="p">(</span><span class="n">snippet_id</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_tracks_progress_empty"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_tracks_progress_empty">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_tracks_progress_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Arroz&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T19:41:43.713Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T23:29:32.452Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw/&quot;</span>
                            <span class="s2">&quot;main/progress.json&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;test snippet 123&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;internal&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.175Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-04T17:09:13.371Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/36.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/36/&quot;</span>
                            <span class="s2">&quot;raw/main/test.txt&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]}]))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_tracks_progress</span><span class="p">(</span><span class="n">snippet_id</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_tracks_progress_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_tracks_progress_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_tracks_progress_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">progress</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}, {&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_2</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;: false}, {</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_3</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}], </span><span class="se">\&quot;</span><span class="s2">learning_track_id</span><span class="se">\&quot;</span><span class="s2">: 216}]&quot;</span>
                         <span class="p">))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_tracks_progress</span><span class="p">(</span><span class="n">snippet_id</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/3/raw&quot;</span><span class="p">))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">UserProgress</span><span class="p">(</span>
            <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">216</span><span class="p">,</span>
            <span class="n">progress</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_1&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_2&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_3&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">list_expected</span> <span class="o">=</span> <span class="p">[</span><span class="n">expected</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">list_expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_track_progress_learning_track_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_track_progress_learning_track_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_progress_learning_track_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Learning track not found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[]))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;Learning track not found.&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track_progress</span><span class="p">(</span><span class="mi">88</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_track_progress_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_track_progress_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_progress_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">progress</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}, {&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_2</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;: false}, {</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_3</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}], </span><span class="se">\&quot;</span><span class="s2">learning_track_id</span><span class="se">\&quot;</span><span class="s2">: 216}]&quot;</span>
                         <span class="p">))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track_progress</span><span class="p">(</span>
            <span class="n">snippet_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">216</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/3/raw&quot;</span><span class="p">))</span>

        <span class="n">excepted</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ResourceProgress</span><span class="p">(</span>
                <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_1&quot;</span><span class="p">,</span>
                <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">ResourceProgress</span><span class="p">(</span>
                <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_2&quot;</span><span class="p">,</span>
                <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">),</span>
            <span class="n">ResourceProgress</span><span class="p">(</span>
                <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_3&quot;</span><span class="p">,</span>
                <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">excepted</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_track_progress_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_track_progress_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_progress_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">progress</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}, {&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_2</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;: false}, {</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_3</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}], </span><span class="se">\&quot;</span><span class="s2">learning_track_id</span><span class="se">\&quot;</span><span class="s2">: 216}]&quot;</span>
                         <span class="p">))</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;User progress not found.&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track_progress</span><span class="p">(</span><span class="n">snippet_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                          <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">212</span>
                                                          <span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_put_learning_track_progress_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_put_learning_track_progress_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_put_learning_track_progress_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Learning track not found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[]))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;Learning track not found.&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">put_learning_track_progress</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_put_learning_track_progress_no_file"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_put_learning_track_progress_no_file">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_put_learning_track_progress_no_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Testing user progress file creation</span>

        <span class="c1"># Learning track exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="c1"># No snippets found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[]))</span>

        <span class="c1"># Snippet creation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">53</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;bananas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;internal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;maria menl&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;35fd4a5b435460c864a9d6d840dade4a?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root1&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-06T10:59:14.476Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-06T10:59:14.476Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/53&quot;</span><span class="p">,</span>
                <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/53/raw&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/53.git&quot;</span><span class="p">,</span>
                <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/53.git&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;test.txt&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/53/raw/&quot;</span>
                        <span class="s2">&quot;main/test.txt&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}))</span>

        <span class="n">progress</span> <span class="o">=</span> <span class="n">UserProgress</span><span class="p">(</span>
            <span class="n">progress</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_1&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_2&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_3&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">put_learning_track_progress</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="n">progress</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_put_learning_track_progress_new_entry"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_put_learning_track_progress_new_entry">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_put_learning_track_progress_new_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Learning track exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="c1"># Snippet found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;User Progress&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T19:41:43.713Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T23:29:32.452Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw/&quot;</span>
                            <span class="s2">&quot;main/progress.json&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">}]))</span>

        <span class="c1"># Existing progress</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">progress</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}, {&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_2</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;: false}, {</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_3</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}], </span><span class="se">\&quot;</span><span class="s2">learning_track_id</span><span class="se">\&quot;</span><span class="s2">: 216}]&quot;</span>
                         <span class="p">))</span>

        <span class="c1"># Snippet update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;bananas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;maria menl&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;35fd4a5b435460c864a9d6d840dade4a?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root1&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-06T12:26:15.677Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-06T12:27:12.483Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/55&quot;</span><span class="p">,</span>
                <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/55/raw&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/55.git&quot;</span><span class="p">,</span>
                <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/55.git&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;adasdas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;adasdas&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/55/raw/&quot;</span>
                        <span class="s2">&quot;main/adasdas&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}))</span>

        <span class="n">progress</span> <span class="o">=</span> <span class="n">UserProgress</span><span class="p">(</span>
            <span class="n">progress</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_1&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_2&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_3&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">put_learning_track_progress</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="n">progress</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/1&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_put_learning_track_progress_update_entry"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_put_learning_track_progress_update_entry">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_put_learning_track_progress_update_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Learning track exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="c1"># Snippet found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;User Progress&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                        <span class="s2">&quot;e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root&quot;</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T19:41:43.713Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-05T23:29:32.452Z&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/51.git&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;progress.json&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/51/raw/&quot;</span>
                            <span class="s2">&quot;main/progress.json&quot;</span>
                        <span class="p">}</span>
                    <span class="p">]</span>
                <span class="p">}]))</span>

        <span class="c1"># Existing progress</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">progress</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;[{</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">:&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id_1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}, {&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_2</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;: false}, {</span><span class="se">\&quot;</span><span class="s2">resource_id</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">resource_id_3</span><span class="se">\&quot;</span><span class="s2">,&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">completed</span><span class="se">\&quot;</span><span class="s2">: false}], </span><span class="se">\&quot;</span><span class="s2">learning_track_id</span><span class="se">\&quot;</span><span class="s2">: 216}]&quot;</span>
                         <span class="p">))</span>

        <span class="c1"># Snippet update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;bananas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;maria menl&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;35fd4a5b435460c864a9d6d840dade4a?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/root1&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-06T12:26:15.677Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;updated_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-06T12:27:12.483Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/55&quot;</span><span class="p">,</span>
                <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/55/raw&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ssh_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;git@localhost:snippets/55.git&quot;</span><span class="p">,</span>
                <span class="s2">&quot;http_url_to_repo&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/snippets/55.git&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;adasdas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;adasdas&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;raw_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://localhost/-/snippets/55/raw/&quot;</span>
                        <span class="s2">&quot;main/adasdas&quot;</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}))</span>

        <span class="n">progress</span> <span class="o">=</span> <span class="n">UserProgress</span><span class="p">(</span>
            <span class="n">progress</span><span class="o">=</span><span class="p">[</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_1&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_2&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">),</span>
                <span class="n">ResourceProgress</span><span class="p">(</span>
                    <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;resource_id_3&quot;</span><span class="p">,</span>
                    <span class="n">completed</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">put_learning_track_progress</span><span class="p">(</span><span class="mi">216</span><span class="p">,</span> <span class="n">progress</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/snippets/1&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_track_commits_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_track_commits_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_commits_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Learning track not found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[])</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabLookupError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track_commits</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_track_commits_sucess"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_track_commits_sucess">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_commits_sucess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Learning track commits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">[{</span>
                <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;9e023e77f0f7b53c17419358aadfcb787921404d&#39;</span><span class="p">,</span>
                <span class="s1">&#39;short_id&#39;</span><span class="p">:</span> <span class="s1">&#39;9e023e77&#39;</span><span class="p">,</span>
                <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="s1">&#39;2023-07-09T14:25:58.000+00:00&#39;</span><span class="p">,</span>
                <span class="s1">&#39;parent_ids&#39;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Create learning track&#39;</span><span class="p">,</span>
                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;{&quot;description&quot;: &quot;string1&quot;, &quot;career&quot;: &quot;string2&quot;}&#39;</span><span class="p">,</span>
                <span class="s1">&#39;author_name&#39;</span><span class="p">:</span> <span class="s1">&#39;antonio antonio&#39;</span><span class="p">,</span>
                <span class="s1">&#39;author_email&#39;</span><span class="p">:</span> <span class="s1">&#39;admin@example.com&#39;</span><span class="p">,</span>
                <span class="s1">&#39;authored_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2023-07-09T14:25:58.000+00:00&#39;</span><span class="p">,</span>
                <span class="s1">&#39;committer_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Administrator&#39;</span><span class="p">,</span>
                <span class="s1">&#39;committer_email&#39;</span><span class="p">:</span> <span class="s1">&#39;admin@example.com&#39;</span><span class="p">,</span>
                <span class="s1">&#39;committed_date&#39;</span><span class="p">:</span> <span class="s1">&#39;2023-07-09T14:25:58.000+00:00&#39;</span><span class="p">,</span>
                <span class="s1">&#39;trailers&#39;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s1">&#39;web_url&#39;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/root/1234567891-2a31b4/&quot;</span>
                <span class="s2">&quot;-/commit/9e023e77f0f7b53c17419358aadfcb787921404d&quot;</span>
            <span class="p">}]</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track_commits</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
            <span class="n">urljoin</span><span class="p">(</span>
                <span class="n">TEST_HOSTNAME</span><span class="p">,</span>
                <span class="s2">&quot;/api/v4/projects/12345/repository/commits?path=track.json&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">excepted</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">LearningTrackCommit</span><span class="p">(</span>
                <span class="n">change_id</span><span class="o">=</span><span class="s1">&#39;9e023e77f0f7b53c17419358aadfcb787921404d&#39;</span><span class="p">,</span>
                <span class="n">short_id</span><span class="o">=</span><span class="s1">&#39;9e023e77&#39;</span><span class="p">,</span>
                <span class="n">created_at</span><span class="o">=</span><span class="s1">&#39;2023-07-09T14:25:58.000+00:00&#39;</span><span class="p">,</span>
                <span class="n">parent_ids</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Create learning track&#39;</span><span class="p">,</span>
                <span class="n">change_message</span><span class="o">=</span><span class="n">dumps</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;string1&quot;</span><span class="p">,</span> <span class="s2">&quot;career&quot;</span><span class="p">:</span> <span class="s2">&quot;string2&quot;</span><span class="p">}</span>
                <span class="p">),</span>
                <span class="n">author_name</span><span class="o">=</span><span class="s1">&#39;antonio antonio&#39;</span><span class="p">,</span>
                <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;admin@example.com&#39;</span><span class="p">,</span>
                <span class="n">authored_date</span><span class="o">=</span><span class="s1">&#39;2023-07-09T14:25:58.000+00:00&#39;</span><span class="p">,</span>
                <span class="n">committer_name</span><span class="o">=</span><span class="s1">&#39;Administrator&#39;</span><span class="p">,</span>
                <span class="n">committer_email</span><span class="o">=</span><span class="s1">&#39;admin@example.com&#39;</span><span class="p">,</span>
                <span class="n">change_date</span><span class="o">=</span><span class="s1">&#39;2023-07-09T14:25:58.000+00:00&#39;</span><span class="p">,</span>
                <span class="n">trailers</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">web_url</span><span class="o">=</span><span class="s2">&quot;http://gitlab.example.com/root/1234567891-2a31b4/&quot;</span>
                <span class="s2">&quot;-/commit/9e023e77f0f7b53c17419358aadfcb787921404d&quot;</span>
            <span class="p">),</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">excepted</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabUserProgressTestCase.test_get_learning_track_commit_id_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabUserProgressTestCase.test_get_learning_track_commit_id_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_learning_track_commit_id_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span>
                <span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span>
                <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 Commit Not Found&quot;</span><span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabLookupError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_learning_track</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span> <span class="n">change_id</span><span class="o">=</span><span class="s2">&quot;abc&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabCopyLearningTrackTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabCopyLearningTrackTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabCopyLearningTrackTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="GitlabCopyLearningTrackTestCase.test_copy_learning_track_404"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabCopyLearningTrackTestCase.test_copy_learning_track_404">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_copy_learning_track_404</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 404&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">expected_exception</span><span class="o">=</span><span class="ne">LookupError</span><span class="p">,</span>
                                    <span class="n">expected_regex</span><span class="o">=</span><span class="s2">&quot;123456&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">copy_learning_track</span><span class="p">(</span><span class="s2">&quot;123456&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabCopyLearningTrackTestCase.test_copy_learning_track_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabCopyLearningTrackTestCase.test_copy_learning_track_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_copy_learning_track_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">123456</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="c1"># Suggestions deleted successfully</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">204</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">copy_learning_track</span><span class="p">(</span><span class="s2">&quot;12345&quot;</span><span class="p">)</span>

        <span class="n">copy_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">delete_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">copy_request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">delete_request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">copy_request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects/12345/fork&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">delete_request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects/123456/repository/&quot;</span>
            <span class="s2">&quot;files/suggestions.json&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">123456</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabCopyLearningTrackTestCase.test_copy_learning_track_success_no_suggestions"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabCopyLearningTrackTestCase.test_copy_learning_track_success_no_suggestions">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_copy_learning_track_success_no_suggestions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="c1"># Suggestions deleted successfully</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">204</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">copy_learning_track</span><span class="p">(</span><span class="s2">&quot;1234&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">12345</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabRevertLearningTrackTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRevertLearningTrackTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabRevertLearningTrackTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="GitlabRevertLearningTrackTestCase.test_revert_learning_track_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRevertLearningTrackTestCase.test_revert_learning_track_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_revert_learning_track_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 201&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
                <span class="s2">&quot;repository_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;antonio antonio&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gravatar.com/avatar/&quot;</span>
                    <span class="s2">&quot;b4f1e541550ac1c63c1e7c90932f7f45?s=80&amp;d=identicon&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab.example.com/antonio&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;str1 123456&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;string&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;branch_name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span>
            <span class="p">}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">revert_learning_track</span><span class="p">(</span>
            <span class="mi">12345</span><span class="p">,</span> <span class="s2">&quot;df9f6c4b5c5eb1f462daca015410f9cb34a2e6f0&quot;</span><span class="p">)</span>

        <span class="n">get_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">put_request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">put_request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">get_request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects/12345/repository/files/&quot;</span>
            <span class="s2">&quot;track.json/raw?ref=df9f6c4b5c5eb1f462daca015410f9cb34a2e6f0&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">put_request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span>
            <span class="s2">&quot;/api/v4/projects/12345/repository/files/track.json&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRevertLearningTrackTestCase.test_revert_learning_track_404"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRevertLearningTrackTestCase.test_revert_learning_track_404">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_revert_learning_track_404</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        404 Commit Not Found</span>
<span class="sd">        404 File Not Found</span>
<span class="sd">        404 Project Not Found</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 Project Not Found&quot;</span>
            <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;123&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">revert_learning_track</span><span class="p">(</span>
                <span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;df9f6c4b5c5eb1f462daca015410f9cb34a2e6f0&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 File Not Found&quot;</span>
            <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;track.json&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">revert_learning_track</span><span class="p">(</span>
                <span class="mi">12345</span><span class="p">,</span> <span class="s2">&quot;df9f6c4b5c5eb1f462daca015410f9cb34a2e6f0&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 Commit Not Found&quot;</span>
            <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;df9f6c4b5c5eb1f462daca015&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">revert_learning_track</span><span class="p">(</span>
                <span class="mi">12345</span><span class="p">,</span> <span class="s2">&quot;df9f6c4b5c5eb1f462daca015&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabRevertLearningTrackTestCase.test_revert_learning_track_Error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRevertLearningTrackTestCase.test_revert_learning_track_Error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_revert_learning_track_Error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns Error&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Error reverting the learning track.&quot;</span>
            <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;Error reverting the learning track.&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">revert_learning_track</span><span class="p">(</span>
                <span class="mi">12345</span><span class="p">,</span> <span class="s2">&quot;df9f6c4b5c5eb1f462daca015410f9cb34a2e6f0&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabRootLongTermTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRootLongTermTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabRootLongTermTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="GitlabRootLongTermTestCase.test_get_root_long_term_token"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabRootLongTermTestCase.test_get_root_long_term_token">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_root_long_term_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;revoked&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-11T20:28:09.757Z&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scopes&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;api&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;read_user&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;sudo&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;read_api&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;read_repository&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;write_repository&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;admin_mode&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;admin_mode&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;last_used_at&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;active&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;expires_at&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="s2">&quot;glpat-LZ3Hf-etrUcezUT3fsSk&quot;</span>
            <span class="p">}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_root_long_term_token</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s2">&quot;glpat-LZ3Hf-etrUcezUT3fsSk&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/users/1/personal_access_tokens&quot;</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="GitlabSuggestionsTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabSuggestionsTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_get_suggestions_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_get_suggestions_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_suggestions_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">915</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;a9016392b8b96e36cf120c945a3d31ae1258147a59f&quot;</span>
                <span class="s2">&quot;8d602e4b0ccbaaab6011e&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;05f7eb136c41ac663a71d039f411be91f71f9f91&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;WwogIHsKICAgICJzdWdnZXN0aW9uX2lkIjogInN0cmluZyIsCi&quot;</span>
                <span class="s2">&quot;AgICAic3VnZ2VzdGlvbl9zdGF0dXMiOiAicmVqZWN0ZWQiLAogICAgImxlc3N&quot;</span>
                <span class="s2">&quot;vbnMiOiBbCiAgICAgIHsKICAgICAgICAibGVzc29uX2lkIjogInN0cmluZyIs&quot;</span>
                <span class="s2">&quot;CiAgICAgICAgIm5hbWUiOiAic3RyaW5nIiwKICAgICAgICAicmVzb3VyY2VzI&quot;</span>
                <span class="s2">&quot;jogWwogICAgICAgICAgewogICAgICAgICAgICAicmVzb3VyY2VfaWQiOiAic3&quot;</span>
                <span class="s2">&quot;RyaW5nIiwKICAgICAgICAgICAgImxpbmsiOiAic3RyaW5nIiwKICAgICAgICA&quot;</span>
                <span class="s2">&quot;gICAgInRpdGxlIjogInN0cmluZyIsCiAgICAgICAgICAgICJzb3VyY2UiOiAi&quot;</span>
                <span class="s2">&quot;c3RyaW5nIiwKICAgICAgICAgICAgInJlc291cmNlX3R5cGUiOiAiYm9vayIsC&quot;</span>
                <span class="s2">&quot;iAgICAgICAgICAgICJkdXJhdGlvbiI6IDAsCiAgICAgICAgICAgICJhZGRlZE&quot;</span>
                <span class="s2">&quot;J5IjogInN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICA&quot;</span>
                <span class="s2">&quot;gIF0KICB9LAogIHsKICAgICJzdWdnZXN0aW9uX2lkIjogInN0cmluZzEiLAog&quot;</span>
                <span class="s2">&quot;ICAgInN1Z2dlc3Rpb25fc3RhdHVzIjogIm9wZW4iLAogICAgImxlc3NvbnMiO&quot;</span>
                <span class="s2">&quot;iBbCiAgICAgIHsKICAgICAgICAibGVzc29uX2lkIjogInN0cmluZyIsCiAgIC&quot;</span>
                <span class="s2">&quot;AgICAgIm5hbWUiOiAic3RyaW5nIiwKICAgICAgICAicmVzb3VyY2VzIjogWwo&quot;</span>
                <span class="s2">&quot;gICAgICAgICAgewogICAgICAgICAgICAicmVzb3VyY2VfaWQiOiAic3RyaW5n&quot;</span>
                <span class="s2">&quot;IiwKICAgICAgICAgICAgImxpbmsiOiAic3RyaW5nIiwKICAgICAgICAgICAgI&quot;</span>
                <span class="s2">&quot;nRpdGxlIjogInN0cmluZyIsCiAgICAgICAgICAgICJzb3VyY2UiOiAic3RyaW&quot;</span>
                <span class="s2">&quot;5nIiwKICAgICAgICAgICAgInJlc291cmNlX3R5cGUiOiAiYm9vayIsCiAgICA&quot;</span>
                <span class="s2">&quot;gICAgICAgICJkdXJhdGlvbiI6IDAsCiAgICAgICAgICAgICJhZGRlZEJ5Ijog&quot;</span>
                <span class="s2">&quot;InN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICAgIF0KI&quot;</span>
                <span class="s2">&quot;CB9Cl0=&quot;</span>
                <span class="p">}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects/1/repository/files/&quot;</span>
            <span class="s2">&quot;suggestions.json/?ref=main&quot;</span><span class="p">))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;suggestion_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="s2">&quot;suggestion_status&quot;</span><span class="p">:</span> <span class="s2">&quot;rejected&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lessons&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;lesson_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;resource_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;resource_type&quot;</span><span class="p">:</span> <span class="s2">&quot;book&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="s2">&quot;addedBy&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">}</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;suggestion_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;suggestion_status&quot;</span><span class="p">:</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lessons&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;lesson_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;resource_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;resource_type&quot;</span><span class="p">:</span> <span class="s2">&quot;book&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="s2">&quot;addedBy&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">}</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                    <span class="p">]</span>
            <span class="p">}</span>
            <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_get_open_suggestions"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_get_open_suggestions">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_open_suggestions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">915</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;a9016392b8b96e36cf120c945a3d31ae1258147a59f&quot;</span>
                <span class="s2">&quot;8d602e4b0ccbaaab6011e&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;05f7eb136c41ac663a71d039f411be91f71f9f91&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;WwogIHsKICAgICJzdWdnZXN0aW9uX2lkIjogInN0cmluZyIsCi&quot;</span>
                <span class="s2">&quot;AgICAic3VnZ2VzdGlvbl9zdGF0dXMiOiAicmVqZWN0ZWQiLAogICAgImxlc3N&quot;</span>
                <span class="s2">&quot;vbnMiOiBbCiAgICAgIHsKICAgICAgICAibGVzc29uX2lkIjogInN0cmluZyIs&quot;</span>
                <span class="s2">&quot;CiAgICAgICAgIm5hbWUiOiAic3RyaW5nIiwKICAgICAgICAicmVzb3VyY2VzI&quot;</span>
                <span class="s2">&quot;jogWwogICAgICAgICAgewogICAgICAgICAgICAicmVzb3VyY2VfaWQiOiAic3&quot;</span>
                <span class="s2">&quot;RyaW5nIiwKICAgICAgICAgICAgImxpbmsiOiAic3RyaW5nIiwKICAgICAgICA&quot;</span>
                <span class="s2">&quot;gICAgInRpdGxlIjogInN0cmluZyIsCiAgICAgICAgICAgICJzb3VyY2UiOiAi&quot;</span>
                <span class="s2">&quot;c3RyaW5nIiwKICAgICAgICAgICAgInJlc291cmNlX3R5cGUiOiAiYm9vayIsC&quot;</span>
                <span class="s2">&quot;iAgICAgICAgICAgICJkdXJhdGlvbiI6IDAsCiAgICAgICAgICAgICJhZGRlZE&quot;</span>
                <span class="s2">&quot;J5IjogInN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICA&quot;</span>
                <span class="s2">&quot;gIF0KICB9LAogIHsKICAgICJzdWdnZXN0aW9uX2lkIjogInN0cmluZzEiLAog&quot;</span>
                <span class="s2">&quot;ICAgInN1Z2dlc3Rpb25fc3RhdHVzIjogIm9wZW4iLAogICAgImxlc3NvbnMiO&quot;</span>
                <span class="s2">&quot;iBbCiAgICAgIHsKICAgICAgICAibGVzc29uX2lkIjogInN0cmluZyIsCiAgIC&quot;</span>
                <span class="s2">&quot;AgICAgIm5hbWUiOiAic3RyaW5nIiwKICAgICAgICAicmVzb3VyY2VzIjogWwo&quot;</span>
                <span class="s2">&quot;gICAgICAgICAgewogICAgICAgICAgICAicmVzb3VyY2VfaWQiOiAic3RyaW5n&quot;</span>
                <span class="s2">&quot;IiwKICAgICAgICAgICAgImxpbmsiOiAic3RyaW5nIiwKICAgICAgICAgICAgI&quot;</span>
                <span class="s2">&quot;nRpdGxlIjogInN0cmluZyIsCiAgICAgICAgICAgICJzb3VyY2UiOiAic3RyaW&quot;</span>
                <span class="s2">&quot;5nIiwKICAgICAgICAgICAgInJlc291cmNlX3R5cGUiOiAiYm9vayIsCiAgICA&quot;</span>
                <span class="s2">&quot;gICAgICAgICJkdXJhdGlvbiI6IDAsCiAgICAgICAgICAgICJhZGRlZEJ5Ijog&quot;</span>
                <span class="s2">&quot;InN0cmluZyIKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICAgIF0KI&quot;</span>
                <span class="s2">&quot;CB9Cl0=&quot;</span>
                <span class="p">}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_open_suggestions</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;GET&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects/1/repository/files/&quot;</span>
            <span class="s2">&quot;suggestions.json/?ref=main&quot;</span><span class="p">))</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;suggestion_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;suggestion_status&quot;</span><span class="p">:</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lessons&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;lesson_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;resource_id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;link&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;resource_type&quot;</span><span class="p">:</span> <span class="s2">&quot;book&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                <span class="s2">&quot;addedBy&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                            <span class="p">}</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                    <span class="p">]</span>
            <span class="p">}</span>
            <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_get_suggestions_learning_track_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_get_suggestions_learning_track_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_suggestions_learning_track_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 Project Not Found&quot;</span>
                <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_get_suggestions_no_suggestions"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_get_suggestions_no_suggestions">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_get_suggestions_no_suggestions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 File Not Found&quot;</span>
                <span class="p">}))</span>

        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_post_suggestions_sucess"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_post_suggestions_sucess">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_suggestions_sucess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 File Not Found&quot;</span>
                <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">201</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span>
                <span class="p">}))</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">LearningTrackSuggestion</span><span class="p">(</span>
            <span class="n">lesson_id</span><span class="o">=</span><span class="s2">&quot;string1&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;dadxadxas&quot;</span><span class="p">,</span>
            <span class="n">resource</span><span class="o">=</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span>
                <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="n">link</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="n">source</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                <span class="n">resource_type</span><span class="o">=</span><span class="s2">&quot;book&quot;</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">addedBy</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">))</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_suggestions</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="p">[</span><span class="n">suggestion</span><span class="p">])</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span> <span class="s2">&quot;/api/v4/projects/123/repository/files/&quot;</span>
            <span class="s2">&quot;suggestions.json&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_post_suggestions_failure"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_post_suggestions_failure">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_suggestions_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;404 File Not Found&quot;</span>
                <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>

        <span class="n">suggestion</span> <span class="o">=</span> <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">LearningTrackSuggestion</span><span class="p">(</span>
                    <span class="n">lesson_id</span><span class="o">=</span><span class="s2">&quot;string1&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;dadxadxas&quot;</span><span class="p">,</span>
                    <span class="n">resource</span><span class="o">=</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">Resource</span><span class="p">(</span>
                        <span class="n">resource_id</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="n">link</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="n">source</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
                        <span class="n">resource_type</span><span class="o">=</span><span class="s2">&quot;book&quot;</span><span class="p">,</span>
                        <span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">addedBy</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">GitlabError</span><span class="p">,</span>
                                    <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">post_suggestions</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="p">[</span><span class="n">suggestion</span><span class="p">])</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_manage_suggestion_not_found"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_manage_suggestion_not_found">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_manage_suggestion_not_found</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">915</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;a9016392b8b96e36cf120c945a3d31ae1258147a59f&quot;</span>
                <span class="s2">&quot;8d602e4b0ccbaaab6011e&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;05f7eb136c41ac663a71d039f411be91f71f9f91&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;WwogICAgewogICAgICAgICJzdWdnZXN0aW9uX2lkIjogInN0cm&quot;</span>
                <span class="s2">&quot;luZyIsCiAgICAgICAgImxlc3Nvbl9pZCI6ICJzdHJpbmciLAogICAgICAgICJ&quot;</span>
                <span class="s2">&quot;uYW1lIjogInN0cmluZyIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogInN0cmlu&quot;</span>
                <span class="s2">&quot;ZyIsCiAgICAgICAgInN1Z2dlc3Rpb25fc3RhdHVzIjogIm9wZW4iLAogICAgI&quot;</span>
                <span class="s2">&quot;CAgICJyZXNvdXJjZSI6IHsKICAgICAgICAgICAgInJlc291cmNlX2lkIjogIn&quot;</span>
                <span class="s2">&quot;N0cmluZyIsCiAgICAgICAgICAgICJsaW5rIjogInN0cmluZyIsCiAgICAgICA&quot;</span>
                <span class="s2">&quot;gICAgICJ0aXRsZSI6ICJzdHJpbmciLAogICAgICAgICAgICAic291cmNlIjog&quot;</span>
                <span class="s2">&quot;InN0cmluZyIsCiAgICAgICAgICAgICJyZXNvdXJjZV90eXBlIjogImJvb2siL&quot;</span>
                <span class="s2">&quot;AogICAgICAgICAgICAiZHVyYXRpb24iOiAwLAogICAgICAgICAgICAiYWRkZW&quot;</span>
                <span class="s2">&quot;RCeSI6ICJzdHJpbmciCiAgICAgICAgfQogICAgfSwKICAgIHsKICAgICAgICA&quot;</span>
                <span class="s2">&quot;ic3VnZ2VzdGlvbl9pZCI6ICJzdHJpbmcxIiwKICAgICAgICAibGVzc29uX2lk&quot;</span>
                <span class="s2">&quot;IjogInN0cmluZzEiLAogICAgICAgICJuYW1lIjogInN0cmluZyIsCiAgICAgI&quot;</span>
                <span class="s2">&quot;CAgImRlc2NyaXB0aW9uIjogInN0cmluZyIsCiAgICAgICAgInN1Z2dlc3Rpb2&quot;</span>
                <span class="s2">&quot;5fc3RhdHVzIjogInJlamVjdCIsCiAgICAgICAgInJlc291cmNlIjogewogICA&quot;</span>
                <span class="s2">&quot;gICAgICAgICAicmVzb3VyY2VfaWQiOiAic3RyaW5nMSIsCiAgICAgICAgICAg&quot;</span>
                <span class="s2">&quot;ICJsaW5rIjogInN0cmluZyIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJzdHJpb&quot;</span>
                <span class="s2">&quot;mciLAogICAgICAgICAgICAic291cmNlIjogInN0cmluZyIsCiAgICAgICAgIC&quot;</span>
                <span class="s2">&quot;AgICJyZXNvdXJjZV90eXBlIjogImJvb2siLAogICAgICAgICAgICAiZHVyYXR&quot;</span>
                <span class="s2">&quot;pb24iOiAwLAogICAgICAgICAgICAiYWRkZWRCeSI6ICJzdHJpbmciCiAgICAg&quot;</span>
                <span class="s2">&quot;ICAgfQogICAgfQpdCg==&quot;</span>
                <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span>
                                    <span class="s2">&quot;Suggestion not found&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">manage_suggestion</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;addsa&quot;</span><span class="p">,</span> <span class="s2">&quot;accept&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_manage_suggestion_success_reject"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_manage_suggestion_success_reject">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_manage_suggestion_success_reject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">915</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;a9016392b8b96e36cf120c945a3d31ae1258147a59f&quot;</span>
                <span class="s2">&quot;8d602e4b0ccbaaab6011e&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;05f7eb136c41ac663a71d039f411be91f71f9f91&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;WwogICAgewogICAgICAgICJzdWdnZXN0aW9uX2lkIjogInN0cm&quot;</span>
                <span class="s2">&quot;luZyIsCiAgICAgICAgImxlc3Nvbl9pZCI6ICJzdHJpbmciLAogICAgICAgICJ&quot;</span>
                <span class="s2">&quot;uYW1lIjogInN0cmluZyIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogInN0cmlu&quot;</span>
                <span class="s2">&quot;ZyIsCiAgICAgICAgInN1Z2dlc3Rpb25fc3RhdHVzIjogIm9wZW4iLAogICAgI&quot;</span>
                <span class="s2">&quot;CAgICJyZXNvdXJjZSI6IHsKICAgICAgICAgICAgInJlc291cmNlX2lkIjogIn&quot;</span>
                <span class="s2">&quot;N0cmluZyIsCiAgICAgICAgICAgICJsaW5rIjogInN0cmluZyIsCiAgICAgICA&quot;</span>
                <span class="s2">&quot;gICAgICJ0aXRsZSI6ICJzdHJpbmciLAogICAgICAgICAgICAic291cmNlIjog&quot;</span>
                <span class="s2">&quot;InN0cmluZyIsCiAgICAgICAgICAgICJyZXNvdXJjZV90eXBlIjogImJvb2siL&quot;</span>
                <span class="s2">&quot;AogICAgICAgICAgICAiZHVyYXRpb24iOiAwLAogICAgICAgICAgICAiYWRkZW&quot;</span>
                <span class="s2">&quot;RCeSI6ICJzdHJpbmciCiAgICAgICAgfQogICAgfSwKICAgIHsKICAgICAgICA&quot;</span>
                <span class="s2">&quot;ic3VnZ2VzdGlvbl9pZCI6ICJzdHJpbmcxIiwKICAgICAgICAibGVzc29uX2lk&quot;</span>
                <span class="s2">&quot;IjogInN0cmluZzEiLAogICAgICAgICJuYW1lIjogInN0cmluZyIsCiAgICAgI&quot;</span>
                <span class="s2">&quot;CAgImRlc2NyaXB0aW9uIjogInN0cmluZyIsCiAgICAgICAgInN1Z2dlc3Rpb2&quot;</span>
                <span class="s2">&quot;5fc3RhdHVzIjogInJlamVjdCIsCiAgICAgICAgInJlc291cmNlIjogewogICA&quot;</span>
                <span class="s2">&quot;gICAgICAgICAicmVzb3VyY2VfaWQiOiAic3RyaW5nMSIsCiAgICAgICAgICAg&quot;</span>
                <span class="s2">&quot;ICJsaW5rIjogInN0cmluZyIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJzdHJpb&quot;</span>
                <span class="s2">&quot;mciLAogICAgICAgICAgICAic291cmNlIjogInN0cmluZyIsCiAgICAgICAgIC&quot;</span>
                <span class="s2">&quot;AgICJyZXNvdXJjZV90eXBlIjogImJvb2siLAogICAgICAgICAgICAiZHVyYXR&quot;</span>
                <span class="s2">&quot;pb24iOiAwLAogICAgICAgICAgICAiYWRkZWRCeSI6ICJzdHJpbmciCiAgICAg&quot;</span>
                <span class="s2">&quot;ICAgfQogICAgfQpdCg==&quot;</span>
                <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;31b12e5abe6e4526d7993018ded7f7b56106c6fd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;short_id&quot;</span><span class="p">:</span> <span class="s2">&quot;31b12e5a&quot;</span><span class="p">,</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-14T19:50:02.000+00:00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;parent_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;46fb6de6f6097537e3a3131f3f3513cb1ae76727&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;batatas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;batatas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author_email&quot;</span><span class="p">:</span> <span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
                <span class="s2">&quot;authored_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-14T19:50:02.000+00:00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;committer_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                <span class="s2">&quot;committer_email&quot;</span><span class="p">:</span> <span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
                <span class="s2">&quot;committed_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-14T19:50:02.000+00:00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;trailers&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab/root/1234567891-119d1a/-/commit/&quot;</span>
                <span class="s2">&quot;31b12e5abe6e4526d7993018ded7f7b56106c6fd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;stats&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;additions&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;deletions&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">2</span>
                <span class="p">},</span>
                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span>
                <span class="s2">&quot;last_pipeline&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">manage_suggestion</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;reject&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">TEST_HOSTNAME</span><span class="p">,</span>
                                              <span class="s2">&quot;api/v4/projects/123/repository&quot;</span>
                                              <span class="s2">&quot;/commits&quot;</span><span class="p">))</span>
        <span class="n">raw_request_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">],</span> <span class="s2">&quot;main&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;commit_message&quot;</span><span class="p">],</span> <span class="s2">&quot;Add resource&quot;</span>
                         <span class="s2">&quot; string to lesson string&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;action&quot;</span><span class="p">],</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">],</span>
                         <span class="s2">&quot;suggestions.json&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_manage_suggestion_suggestion_not_open"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_manage_suggestion_suggestion_not_open">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_manage_suggestion_suggestion_not_open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">915</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;a9016392b8b96e36cf120c945a3d31ae1258147a59f&quot;</span>
                <span class="s2">&quot;8d602e4b0ccbaaab6011e&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;05f7eb136c41ac663a71d039f411be91f71f9f91&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;WwogICAgewogICAgICAgICJzdWdnZXN0aW9uX2lkIjogInN0cm&quot;</span>
                <span class="s2">&quot;luZyIsCiAgICAgICAgImxlc3Nvbl9pZCI6ICJzdHJpbmciLAogICAgICAgICJ&quot;</span>
                <span class="s2">&quot;uYW1lIjogInN0cmluZyIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogInN0cmlu&quot;</span>
                <span class="s2">&quot;ZyIsCiAgICAgICAgInN1Z2dlc3Rpb25fc3RhdHVzIjogIm9wZW4iLAogICAgI&quot;</span>
                <span class="s2">&quot;CAgICJyZXNvdXJjZSI6IHsKICAgICAgICAgICAgInJlc291cmNlX2lkIjogIn&quot;</span>
                <span class="s2">&quot;N0cmluZyIsCiAgICAgICAgICAgICJsaW5rIjogInN0cmluZyIsCiAgICAgICA&quot;</span>
                <span class="s2">&quot;gICAgICJ0aXRsZSI6ICJzdHJpbmciLAogICAgICAgICAgICAic291cmNlIjog&quot;</span>
                <span class="s2">&quot;InN0cmluZyIsCiAgICAgICAgICAgICJyZXNvdXJjZV90eXBlIjogImJvb2siL&quot;</span>
                <span class="s2">&quot;AogICAgICAgICAgICAiZHVyYXRpb24iOiAwLAogICAgICAgICAgICAiYWRkZW&quot;</span>
                <span class="s2">&quot;RCeSI6ICJzdHJpbmciCiAgICAgICAgfQogICAgfSwKICAgIHsKICAgICAgICA&quot;</span>
                <span class="s2">&quot;ic3VnZ2VzdGlvbl9pZCI6ICJzdHJpbmcxIiwKICAgICAgICAibGVzc29uX2lk&quot;</span>
                <span class="s2">&quot;IjogInN0cmluZzEiLAogICAgICAgICJuYW1lIjogInN0cmluZyIsCiAgICAgI&quot;</span>
                <span class="s2">&quot;CAgImRlc2NyaXB0aW9uIjogInN0cmluZyIsCiAgICAgICAgInN1Z2dlc3Rpb2&quot;</span>
                <span class="s2">&quot;5fc3RhdHVzIjogInJlamVjdCIsCiAgICAgICAgInJlc291cmNlIjogewogICA&quot;</span>
                <span class="s2">&quot;gICAgICAgICAicmVzb3VyY2VfaWQiOiAic3RyaW5nMSIsCiAgICAgICAgICAg&quot;</span>
                <span class="s2">&quot;ICJsaW5rIjogInN0cmluZyIsCiAgICAgICAgICAgICJ0aXRsZSI6ICJzdHJpb&quot;</span>
                <span class="s2">&quot;mciLAogICAgICAgICAgICAic291cmNlIjogInN0cmluZyIsCiAgICAgICAgIC&quot;</span>
                <span class="s2">&quot;AgICJyZXNvdXJjZV90eXBlIjogImJvb2siLAogICAgICAgICAgICAiZHVyYXR&quot;</span>
                <span class="s2">&quot;pb24iOiAwLAogICAgICAgICAgICAiYWRkZWRCeSI6ICJzdHJpbmciCiAgICAg&quot;</span>
                <span class="s2">&quot;ICAgfQogICAgfQpdCg==&quot;</span>
                <span class="p">}))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">LookupError</span><span class="p">,</span>
                                    <span class="s2">&quot;Suggestion already managed.&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">manage_suggestion</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;string1&quot;</span><span class="p">,</span> <span class="s2">&quot;accept&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabSuggestionsTestCase.test_manage_suggestion_success_approve"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabSuggestionsTestCase.test_manage_suggestion_success_approve">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_manage_suggestion_success_approve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;suggestions.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">915</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;a9016392b8b96e36cf120c945a3d31ae1258147a59f&quot;</span>
                <span class="s2">&quot;8d602e4b0ccbaaab6011e&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;05f7eb136c41ac663a71d039f411be91f71f9f91&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;be80fabd2487ab43b4431ca8dd413310e0879b22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;WwogICAgewogICAgICAgICJzdWdnZXN0aW9uX2lkIjogInN0cm&quot;</span>
                <span class="s2">&quot;luZyIsCiAgICAgICAgImxlc3Nvbl9pZCI6ICJzb21lVVVJRCIsCiAgICAgICA&quot;</span>
                <span class="s2">&quot;gIm5hbWUiOiAic3RyaW5nIiwKICAgICAgICAiZGVzY3JpcHRpb24iOiAic3Ry&quot;</span>
                <span class="s2">&quot;aW5nIiwKICAgICAgICAic3VnZ2VzdGlvbl9zdGF0dXMiOiAib3BlbiIsCiAgI&quot;</span>
                <span class="s2">&quot;CAgICAgInJlc291cmNlIjogewogICAgICAgICAgICAicmVzb3VyY2VfaWQiOi&quot;</span>
                <span class="s2">&quot;Aic3RyaW5nIiwKICAgICAgICAgICAgImxpbmsiOiAic3RyaW5nIiwKICAgICA&quot;</span>
                <span class="s2">&quot;gICAgICAgInRpdGxlIjogInN0cmluZyIsCiAgICAgICAgICAgICJzb3VyY2Ui&quot;</span>
                <span class="s2">&quot;OiAic3RyaW5nIiwKICAgICAgICAgICAgInJlc291cmNlX3R5cGUiOiAiYm9va&quot;</span>
                <span class="s2">&quot;yIsCiAgICAgICAgICAgICJkdXJhdGlvbiI6IDAsCiAgICAgICAgICAgICJhZG&quot;</span>
                <span class="s2">&quot;RlZEJ5IjogInN0cmluZyIKICAgICAgICB9CiAgICB9LAogICAgewogICAgICA&quot;</span>
                <span class="s2">&quot;gICJzdWdnZXN0aW9uX2lkIjogInN0cmluZzEiLAogICAgICAgICJsZXNzb25f&quot;</span>
                <span class="s2">&quot;aWQiOiAic3RyaW5nMSIsCiAgICAgICAgIm5hbWUiOiAic3RyaW5nIiwKICAgI&quot;</span>
                <span class="s2">&quot;CAgICAiZGVzY3JpcHRpb24iOiAic3RyaW5nIiwKICAgICAgICAic3VnZ2VzdG&quot;</span>
                <span class="s2">&quot;lvbl9zdGF0dXMiOiAicmVqZWN0IiwKICAgICAgICAicmVzb3VyY2UiOiB7CiA&quot;</span>
                <span class="s2">&quot;gICAgICAgICAgICJyZXNvdXJjZV9pZCI6ICJzdHJpbmcxIiwKICAgICAgICAg&quot;</span>
                <span class="s2">&quot;ICAgImxpbmsiOiAic3RyaW5nIiwKICAgICAgICAgICAgInRpdGxlIjogInN0c&quot;</span>
                <span class="s2">&quot;mluZyIsCiAgICAgICAgICAgICJzb3VyY2UiOiAic3RyaW5nIiwKICAgICAgIC&quot;</span>
                <span class="s2">&quot;AgICAgInJlc291cmNlX3R5cGUiOiAiYm9vayIsCiAgICAgICAgICAgICJkdXJ&quot;</span>
                <span class="s2">&quot;hdGlvbiI6IDAsCiAgICAgICAgICAgICJhZGRlZEJ5IjogInN0cmluZyIKICAg&quot;</span>
                <span class="s2">&quot;ICAgICB9CiAgICB9Cl0K&quot;</span>
                <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2121</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;d142e040117e680aafe515a53a33f4baeb49fc38953&quot;</span>
                <span class="s2">&quot;5edeb91869a917b173571&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f5443b5921eb1b4fa4367eaffa17532b213d47b2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d6fa002403c8515afe0d0f215cfdf7f2631ef518&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d6fa002403c8515afe0d0f215cfdf7f2631ef518&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;ewoJImNhcmVlcl9wYXRoIjogInNvbWVDYXJlZXJQYXRoIiw&quot;</span>
                <span class="s2">&quot;KCSJsZXZlbCI6ICJleHBlcnQiLAoJInNraWxscyI6ICJza2lsbHMiL&quot;</span>
                <span class="s2">&quot;AoJImxlc3NvbnMiOiBbewoJCSJsZXNzb25faWQiOiAic29tZVVVSUQ&quot;</span>
                <span class="s2">&quot;iLAoJCSJuYW1lIjogInNvbWVOYW1lIiwKCQkicmVzb3VyY2VzIjogW3&quot;</span>
                <span class="s2">&quot;sKCQkJCSJsaW5rIjogImh0dHA6Ly8uc29tZWxpbmsuY29tIiwKCQkJC&quot;</span>
                <span class="s2">&quot;SJyZXNvdXJjZV9pZCI6ICJzb21lVVVJRCIsCgkJCQkidGl0bGUiOiAi&quot;</span>
                <span class="s2">&quot;c29tZVRpdGxlIiwKCQkJCSJzb3VyY2UiOiAic29tZVRpdGxlIiwKCQkJ&quot;</span>
                <span class="s2">&quot;CSJyZXNvdXJjZV90eXBlIjogImJvb2siLAoJCQkJImR1cmF0aW9uIjog&quot;</span>
                <span class="s2">&quot;MTAsCgkJCQkiYWRkZWRCeSI6ICJxdWltYmFycmVpcm9zIgoJCQl9LAoJ&quot;</span>
                <span class="s2">&quot;CQl7CgkJCQkibGluayI6ICJodHRwOi8vLnNvbWVsaW5rLmNvbSIsCgkJ&quot;</span>
                <span class="s2">&quot;CQkicmVzb3VyY2VfaWQiOiAic29tZVVVSUQiLAoJCQkJInRpdGxlIjog&quot;</span>
                <span class="s2">&quot;InNvbWVUaXRsZSIsCgkJCQkic291cmNlIjogInNvbWVUaXRsZSIsCgkJ&quot;</span>
                <span class="s2">&quot;CQkicmVzb3VyY2VfdHlwZSI6ICJib29rIiwKCQkJCSJkdXJhdGlvbiI6&quot;</span>
                <span class="s2">&quot;IDEwLAoJCQkJImFkZGVkQnkiOiAicXVpbWJhcnJlaXJvcyIKCQkJfQoJ&quot;</span>
                <span class="s2">&quot;CV0KCgl9XQp9&quot;</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;31b12e5abe6e4526d7993018ded7f7b56106c6fd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;short_id&quot;</span><span class="p">:</span> <span class="s2">&quot;31b12e5a&quot;</span><span class="p">,</span>
                <span class="s2">&quot;created_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-14T19:50:02.000+00:00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;parent_ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;46fb6de6f6097537e3a3131f3f3513cb1ae76727&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;batatas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;batatas&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author_email&quot;</span><span class="p">:</span> <span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
                <span class="s2">&quot;authored_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-14T19:50:02.000+00:00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;committer_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                <span class="s2">&quot;committer_email&quot;</span><span class="p">:</span> <span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
                <span class="s2">&quot;committed_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-07-14T19:50:02.000+00:00&quot;</span><span class="p">,</span>
                <span class="s2">&quot;trailers&quot;</span><span class="p">:</span> <span class="p">{},</span>
                <span class="s2">&quot;web_url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://gitlab/root/1234567891-119d1a/-/commit/&quot;</span>
                <span class="s2">&quot;31b12e5abe6e4526d7993018ded7f7b56106c6fd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;stats&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;additions&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;deletions&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">2</span>
                <span class="p">},</span>
                <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;project_id&quot;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span>
                <span class="s2">&quot;last_pipeline&quot;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}))</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">manage_suggestion</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;approve&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span><span class="n">TEST_HOSTNAME</span><span class="p">,</span>
                                              <span class="s2">&quot;api/v4/projects/123/repository&quot;</span>
                                              <span class="s2">&quot;/commits&quot;</span><span class="p">))</span>
        <span class="n">raw_request_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">],</span> <span class="s2">&quot;main&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;commit_message&quot;</span><span class="p">],</span> <span class="s2">&quot;Add resource&quot;</span>
                         <span class="s2">&quot; string to lesson string&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;action&quot;</span><span class="p">],</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">],</span>
                         <span class="s2">&quot;track.json&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;action&quot;</span><span class="p">],</span> <span class="s2">&quot;update&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">raw_request_data</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">],</span>
                         <span class="s2">&quot;suggestions.json&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabEditLearningTrackTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabEditLearningTrackTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabEditLearningTrackTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>
<div class="viewcode-block" id="GitlabEditLearningTrackTestCase.setUp"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabEditLearningTrackTestCase.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">access_token</span> <span class="o">=</span> <span class="s2">&quot;test_access&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_patch</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;replace&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;newTitle4&quot;</span>
            <span class="p">}]</span></div>

<div class="viewcode-block" id="GitlabEditLearningTrackTestCase.test_edit_learning_track_success"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabEditLearningTrackTestCase.test_edit_learning_track_success">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_edit_learning_track_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">2121</span><span class="p">,</span>
                <span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;base64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content_sha256&quot;</span><span class="p">:</span> <span class="s2">&quot;d142e040117e680aafe515a53a33f4baeb49fc38953&quot;</span>
                <span class="s2">&quot;5edeb91869a917b173571&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ref&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;blob_id&quot;</span><span class="p">:</span> <span class="s2">&quot;f5443b5921eb1b4fa4367eaffa17532b213d47b2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d6fa002403c8515afe0d0f215cfdf7f2631ef518&quot;</span><span class="p">,</span>
                <span class="s2">&quot;last_commit_id&quot;</span><span class="p">:</span> <span class="s2">&quot;d6fa002403c8515afe0d0f215cfdf7f2631ef518&quot;</span><span class="p">,</span>
                <span class="s2">&quot;execute_filemode&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
                <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;ew0KICAic2tpbGxzIjogWw0KICAgICJza2lsbHMiDQogIF0&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;sDQogICJsZXNzb25zIjogWw0KICAgIHsNCiAgICAgICJsZXNzb25faWQiO&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;iAic29tZVVVSUQiLA0KICAgICAgIm5hbWUiOiAic29tZU5hbWUiLA0KICAg&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;ICAgInJlc291cmNlcyI6IFsNCiAgICAgICAgew0KICAgICAgICAgICJsa&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;W5rIjogImh0dHA6Ly8uc29tZWxpbmsuY29tIiwNCiAgICAgICAgICAicmV&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;zb3VyY2VfaWQiOiAic29tZVVVSUQiLA0KICAgICAgICAgICJ0aXRsZSI6IC&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;Jzb21lVGl0bGUiLA0KICAgICAgICAgICJzb3VyY2UiOiAic29tZVRpdGxl&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;IiwNCiAgICAgICAgICAicmVzb3VyY2VfdHlwZSI6ICJib29rIiwNCiAgICA&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;gICAgICAiZHVyYXRpb24iOiAxMCwNCiAgICAgICAgICAiYWRkZWRCeSI6IC&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;JxdWltYmFycmVpcm9zIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAg&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;ICAgICAgImxpbmsiOiAiaHR0cDovLy5zb21lbGluay5jb20iLA0KICAgI&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;CAgICAgICJyZXNvdXJjZV9pZCI6ICJzb21lVVVJRCIsDQogICAgICAgIC&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;AgInRpdGxlIjogInNvbWVUaXRsZSIsDQogICAgICAgICAgInNvdXJjZSI6&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;ICJzb21lVGl0bGUiLA0KICAgICAgICAgICJyZXNvdXJjZV90eXBlIjogIm&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;Jvb2siLA0KICAgICAgICAgICJkdXJhdGlvbiI6IDEwLA0KICAgICAgICAgI&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;CJhZGRlZEJ5IjogInF1aW1iYXJyZWlyb3MiDQogICAgICAgIH0NCiAgICA&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;gIF0NCiAgICB9DQogIF0NCn0=&quot;</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Don&#39;t know any python? &quot;</span> <span class="o">+</span>
                <span class="s2">&quot;Don&#39;t worry! Use your hammer!</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">:&quot;</span> <span class="o">+</span>
                <span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">Engineering</span><span class="se">\&quot;</span><span class="s2">,&quot;</span> <span class="o">+</span>
                <span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">career_path</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Software development</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">level</span><span class="se">\&quot;</span><span class="s2">:&quot;</span> <span class="o">+</span>
                <span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">beginner</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;newTitle4 1d0049&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name_with_namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator / newTitle4 1d0049&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;how-to-hammer-in-be-6fb1b9&quot;</span><span class="p">,</span>
                <span class="s2">&quot;default_branch&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="s2">&quot;builds_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;disabled&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://gitlab.mse22.onept.pt:23457/uploads/&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;-/system/project/avatar/1/avatar.jpg&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://secure.gravatar.com/avatar&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;/e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span>
                <span class="p">}</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">description</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string1</span><span class="se">\&quot;</span><span class="s2">,&quot;</span> <span class="o">+</span>
                <span class="s2">&quot; </span><span class="se">\&quot;</span><span class="s2">career</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">string2</span><span class="se">\&quot;</span><span class="s2">}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;newTitle3 c58803&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;how-to-hammer-in-be-6fb1b9&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tag_list&quot;</span><span class="p">:</span> <span class="p">[</span>

                <span class="p">],</span>
                <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span>

                <span class="p">],</span>
                <span class="s2">&quot;builds_access_level&quot;</span><span class="p">:</span> <span class="s2">&quot;disable&quot;</span><span class="p">,</span>
                <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://gitlab.mse22.onept.pt:23457/uploads/&quot;</span> <span class="o">+</span>
                <span class="s2">&quot;-/system/project/avatar/1/avatar.jpg&quot;</span><span class="p">,</span>
                <span class="s2">&quot;visibility&quot;</span><span class="p">:</span> <span class="s2">&quot;public&quot;</span><span class="p">,</span>
                <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;avatar_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://secure.gravatar.com/avatar&quot;</span> <span class="o">+</span>
                    <span class="s2">&quot;/e64c7d89f26bd1972efa854d13d7dd61?s=80&amp;d=identicon&quot;</span>
                <span class="p">}</span>
            <span class="p">}))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">body_dict</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;track.json&quot;</span><span class="p">,</span>
                <span class="s2">&quot;branch&quot;</span><span class="p">:</span> <span class="s2">&quot;main&quot;</span><span class="p">}))</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">edit_learning_track</span><span class="p">(</span>
            <span class="n">learning_track_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">patch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">list_patch</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;PUT&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span>
            <span class="s2">&quot;/api/v4/projects/1/repository/files/track.json&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="GitlabEditLearningTrackTestCase.test_post_learning_track_gitlab_error"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabEditLearningTrackTestCase.test_post_learning_track_gitlab_error">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_post_learning_track_gitlab_error</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 500 when something goes wrong&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GitlabError</span><span class="p">,</span> <span class="s2">&quot;Gitlab returned status code 500&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">edit_learning_track</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_patch</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GitlabDeleteLearningTrackTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabDeleteLearningTrackTestCase">[docs]</a><span class="k">class</span> <span class="nc">GitlabDeleteLearningTrackTestCase</span><span class="p">(</span><span class="n">GitlabMixin</span><span class="p">,</span> <span class="n">IsolatedAsyncioTestCase</span><span class="p">):</span>

<div class="viewcode-block" id="GitlabDeleteLearningTrackTestCase.test_delete_learning_track_404"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabDeleteLearningTrackTestCase.test_delete_learning_track_404">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_delete_learning_track_404</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gitlab returns 404&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="n">expected_exception</span><span class="o">=</span><span class="ne">LookupError</span><span class="p">,</span>
                                    <span class="n">expected_regex</span><span class="o">=</span><span class="s2">&quot;123456&quot;</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">delete_learning_track</span><span class="p">(</span><span class="s2">&quot;123456&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GitlabDeleteLearningTrackTestCase.test_delete_learning_track"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.GitlabDeleteLearningTrackTestCase.test_delete_learning_track">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_delete_learning_track</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">FakeResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="mi">202</span><span class="p">))</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">gitlab</span><span class="o">.</span><span class="n">delete_learning_track</span><span class="p">(</span><span class="s2">&quot;123456&quot;</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fake_session</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">urljoin</span><span class="p">(</span>
            <span class="n">TEST_HOSTNAME</span><span class="p">,</span>
            <span class="s2">&quot;/api/v4/projects/123456&quot;</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="ResizeImageTestCase"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.ResizeImageTestCase">[docs]</a><span class="k">class</span> <span class="nc">ResizeImageTestCase</span><span class="p">(</span>
    <span class="n">GitlabMixin</span><span class="p">,</span>
    <span class="n">IsolatedAsyncioTestCase</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">def</span> <span class="nf">_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytearray</span><span class="p">:</span>
        <span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
        <span class="n">image_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;images/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">thumbnail_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">thumbnail_image</span>

<div class="viewcode-block" id="ResizeImageTestCase.test_jpeg_small_jpeg"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.ResizeImageTestCase.test_jpeg_small_jpeg">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_jpeg_small_jpeg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file</span><span class="p">(</span><span class="s2">&quot;image.jpg&quot;</span><span class="p">)</span>

        <span class="n">image</span> <span class="o">=</span> <span class="n">GitlabImage</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
            <span class="n">image</span><span class="p">,</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">API_MAX_IMAGE_SIZE</span><span class="p">,</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GITLAB_MAX_IMAGE_SIZE</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">),</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GITLAB_MAX_IMAGE_SIZE</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ResizeImageTestCase.test_jpeg_too_big"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.ResizeImageTestCase.test_jpeg_too_big">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_jpeg_too_big</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file</span><span class="p">(</span><span class="s2">&quot;image_4MB.jpg&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">gitlab_facade</span><span class="o">.</span><span class="n">InvalidFileSizeError</span><span class="p">):</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">GitlabImage</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
                <span class="n">image</span><span class="p">,</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">API_MAX_IMAGE_SIZE</span><span class="p">,</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GITLAB_MAX_IMAGE_SIZE</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="ResizeImageTestCase.test_jpeg_big"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.ResizeImageTestCase.test_jpeg_big">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_jpeg_big</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file</span><span class="p">(</span><span class="s2">&quot;image_2MB.jpg&quot;</span><span class="p">)</span>

        <span class="n">image</span> <span class="o">=</span> <span class="n">GitlabImage</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
            <span class="n">image</span><span class="p">,</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">API_MAX_IMAGE_SIZE</span><span class="p">,</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GITLAB_MAX_IMAGE_SIZE</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertLessEqual</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">),</span>
            <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GITLAB_MAX_IMAGE_SIZE</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="ResizeImageTestCase.test_invalid_image"><a class="viewcode-back" href="../../tests.html#tests.test_gitlab.ResizeImageTestCase.test_invalid_image">[docs]</a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">test_invalid_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;file&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaisesRegex</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="s2">&quot;Invalid image.&quot;</span><span class="p">):</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">GitlabImage</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
                <span class="n">image</span><span class="p">,</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">API_MAX_IMAGE_SIZE</span><span class="p">,</span>
                <span class="n">gitlab_facade</span><span class="o">.</span><span class="n">GITLAB_MAX_IMAGE_SIZE</span>
            <span class="p">)</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
    <span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">main</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, MSE 2022 Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>